# 5장. 책임 할당하기

### 책임 주도 개발은

- 객체에게 어떤 책임을 줄 지 가장 어렵다.
- 트레이드오프 활동이다.
- 책임의 분배를 다양한 관점에서 평가하자.

### 1. 책임 주도 설계를 향해

- 데이터보다 행동을 먼저 결정하라
- 협력이라는 문맥 안에서 책임을 결정하라
    - 책임은 객체의 입장이 아니라 객체가 참여하는 협력에 적합해야 한다.
    - 즉, 메시지의 수신자가 아니라 발신자(클라이언트)에게 적합한 책임이어야 한다.
    - 클라이언트가 발신할 메시지를 선택하고, 그 메시지를 처리할 객체를 선택하는 것이다. (객체가 메시지 선택 x, 메시지가 객체를 선택) (클래스 기반 설계 -> 메시지 기반 설계) (캡슐화가 자동으로 이루어짐!)
    - 데이터는 그 다음에!

### 2. 책임 할당을 위한 GRASP 패턴

1. 도메인 개념에서 출발하기
    - 구현을 가이드 할 수 있을 정도로 도메인 설계를 구상한다.(너무 자세하게는 x, 하지만 구현과 밀접한 관계를 가질 수 있게끔)
2. 정보 전문가에게 책임 할당

    도메인을 토대로

    - 메시지를 결정하고
    - 해당 메시지를 필요한 정보를 '알아낼 수 있는' '정보전문가'에게 맡김
    - 정보 전문가의 내부 로직을 대략적으로 고민하고, 외부에 도움을 요청해야 하는 경우를 판단해 새로운 메시지 결정
3. High Cohesion, Low Coupling

    책임 할당 시 항상 고려해야 하는 기본 원리

4. CREATOR 패턴

    객체의 생성을 누구에게 맡겨야 하지?

    - 생성될 객체를 포함/ 참조하거나
    - 생성될 객체를 기록하거나
    - 생성된 객체를 긴밀하게 사용하고
    - 생성될 객체의 정보전문가 객체에게
    이를 최대한 많이 충족하는 객체에게 생성을 맡기는 것

### 3. 구현을 통한 검증

1. 문제점
    - 서로 연관성이 없는 기능이나 데이터가 하나의 클래스 안에 있는 경우, 응집도가 낮다고 표현한다.
    - 응집도가 낮은 지 검증하는 세 가지 방법 :
        - 클래스가 하나 이상의 이유로 변경되는 경우
        - 클래스의 인스턴스를 초기화 하는 시점에서, 경우에 따라 서로 다른 속성들을 초기화 하는 경우(초기화 되는 속성이 일부인 경우) -> 초기화 되는 속서으이 그룹으로 클래스 분리
        - 메서드 그룹에 따라 속성 그룹이 나뉘는 경우 (메서드에 따라 속성을 일부만 사용하는 경우)
2. 타입 분리하기, 다형성 패턴 사용하기, 변경으로부터 보호하기
    - 타입별로 조건 논리를 사용해 로직을 분리하면 변화에 취약하므로, 타입별로 클래스를 나누고 다형성을 이용해 확장성을 키우자.
    - Protected Variations 패턴 -> 변경이 예측되는 부분을 캡슐화하라.
3. Movie 클래스 개선하기
    - 도메인의 구조 -> 코드의 구조화
    - 도메인 주도 개발의 내용이 파트에 잠시 언급
4. 변경과 유연성
    - 유연성을 위해 상속 대신 합성 사용

### 4.책임 주도 설계의 대안

책임 주도 설계를 순서대로 따라가기 어렵다면, 빠른 속도로 코딩한 다음 객체지향적 코드로 'Refactoring'

- 메서드 응집도 향상
    - 주석 대신 작고 응집도 강한 메서드로
    - 이해하기 쉬운 이름 사용
- 메서드를 적절한 클래스에 재 배치
    - 메서드가 사용하는 데이터를 저장하고 있는 클래스로 이동
    - 메서드가 어떤 클래스의 접근자 메서드를 사용하는지 확인하자.
    - 주로 인자에 정의된 클래스 중 하나로 이동